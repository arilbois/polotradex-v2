// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}


model Configuration {
  id                  String   @id @default("main_config")
  
  tradingSymbol       String   @default("BTC/USDT")
  strategyName        String   @default("RSI")

  orderPercentage     Float    @default(50)

  // Parameter strategi RSI
  rsiPeriod           Int
  overboughtThreshold Int
  oversoldThreshold   Int
  timeframe           String

  // [BARU] Parameter strategi MACD
  macdFastPeriod      Int      @default(12)
  macdSlowPeriod      Int      @default(26)
  macdSignalPeriod    Int      @default(9)

  // Parameter Manajemen Risiko
  stopLossPercentage  Float    @default(0)
  takeProfitPercentage Float   @default(0)

  isMonitoringEnabled Boolean  @default(false) 

  srLookbackPeriod    Int      @default(50)  // Jumlah candle ke belakang untuk dianalisis
  srPivotStrength     Int      @default(5)

  mtfTimeframe        String   @default("4h")

  // [BARU] Parameter untuk Cooldown Period
  cooldownTicks       Int      @default(5) 

  createdAt           DateTime @default(now())
  updatedAt           DateTime @updatedAt
}

model TradeLog {
  id        String   @id @default(cuid()) // ID unik untuk setiap log
  symbol    String   // Contoh: "BTC/USDT"
  action    String   // "BUY" atau "SELL"
  reason    String   // Alasan dari strategi, misal: "RSI oversold (28.5)"
  price     Float    // Harga eksekusi (simulasi)
  quantity  Float    // Jumlah yang dibeli/dijual (simulasi)
  fee       Float    @default(0)
  timestamp DateTime @default(now())
}

model OpenPosition {
  // Kita hanya akan punya satu posisi aktif, jadi ID-nya bisa statis.
  id         String   @id @default("active_position")

  symbol     String
  entryPrice Float
  quantity   Float
  timestamp  DateTime
}
